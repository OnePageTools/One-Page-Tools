<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>One Page Tools - 30+ Free Online Utilities</title>
    <meta name="description" content="The ultimate collection of 30+ free online tools on a single page. Convert images, format JSON, generate hashes, calculate EMI, manage text, and much more. Fast, secure, and privacy-focused.">
    <meta name="keywords" content="online tools, free tools, image converter, image compressor, image resizer, image cropper, video converter, audio converter, audio trimmer, age calculator, emi calculator, sip calculator, tip calculator, countdown timer, qr code generator, password generator, word counter, case converter, find and replace, lorem ipsum generator, base64 encoder, base64 decoder, color picker, text to speech, speech to text, json formatter, unit converter, bmi calculator, timer, stopwatch, hash generator, md5 generator, sha256 generator, markdown previewer, url encoder, url decoder, random number generator, free online utilities, developer tools, client-side tools, web tools, free utilities">
    
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/OnePageTools/One-Page-Tools/logo.jpg.png
" type="image/jpeg">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.0/dist/ffmpeg.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.1/dist/purify.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --background-color: #1a1a2e;
            --header-background: #16213e;
            --tool-card-background: #0f3460;
            --accent-color: #53a8b6;
            --text-color: #e3e3e3;
            --heading-color: #ffffff;
            --button-hover-color: #63c2d1;
            --font-family: 'Poppins', sans-serif;
            --card-shadow: rgba(0, 0, 0, 0.2);
            --accent-shadow: rgba(83, 168, 182, 0.3);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-family); background-color: var(--background-color); color: var(--text-color); line-height: 1.7; padding-bottom: 50px; }
        
        header { 
            background-color: #16213e;
            /* YAHAN APNA HEADER IMAGE KA GITHUB URL DAALEIN */
            background-image: linear-gradient(rgba(22, 33, 62, 0.85), rgba(22, 33, 62, 0.85)), url(https://cdn.jsdelivr.net/gh/OnePageTools/One-Page-Tools/header-image.jpg.png
);
            background-size: cover;
            background-position: center;
            color: var(--heading-color); 
            padding: 2rem 1rem; 
            text-align: center; 
            box-shadow: 0 4px 15px var(--card-shadow); 
            margin-bottom: 2rem; 
            border-bottom: 3px solid var(--accent-color);
            position: relative;
        }
        .header-content { display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .logo { width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--accent-color); }
        header h1 { font-weight: 700; font-size: 2.8rem; letter-spacing: 1px; margin: 0; }
        main { max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; }
        .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.8rem; }
        .tool-card { background-color: var(--tool-card-background); padding: 1.5rem; border-radius: 12px; box-shadow: 0 5px 15px var(--card-shadow); transition: transform 0.3s ease, box-shadow 0.3s ease; display: flex; flex-direction: column; border: 1px solid rgba(255, 255, 255, 0.1); opacity: 0; animation: fadeInUp 0.5s ease-out forwards; }
        .tool-card:hover { transform: translateY(-8px); box-shadow: 0 12px 25px var(--accent-shadow); }
        .tool-card .icon-container { font-size: 2.5rem; color: var(--accent-color); margin-bottom: 1rem; }
        .tool-card h2 { font-size: 1.4rem; margin-bottom: 0.75rem; color: var(--heading-color); }
        .tool-card p { font-size: 0.9rem; margin-bottom: 1.5rem; flex-grow: 1; opacity: 0.8; }
        .tool-button { background-color: var(--accent-color); color: var(--heading-color); border: none; padding: 0.75rem 1.25rem; border-radius: 8px; font-weight: 600; cursor: pointer; text-align: center; transition: all 0.3s ease; align-self: flex-start; }
        .tool-button:hover { background-color: var(--button-hover-color); transform: scale(1.05); }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); animation: fadeIn 0.3s ease; }
        .modal-content { background-color: var(--header-background); margin: 5% auto; padding: 30px; border-radius: 15px; width: 90%; max-width: 750px; box-shadow: 0 10px 30px rgba(0,0,0,0.4); position: relative; animation: slideIn 0.4s ease-out; border: 1px solid rgba(255,255,255,0.2); }
        .close-button { color: var(--text-color); position: absolute; top: 15px; right: 20px; font-size: 2rem; font-weight: bold; transition: color 0.2s ease, transform 0.2s ease; }
        .close-button:hover, .close-button:focus { color: var(--accent-color); text-decoration: none; cursor: pointer; transform: scale(1.2); }
        #modalTitle { color: var(--accent-color); }
        .modal-body { margin-top: 1.5rem; color: var(--text-color); }
        .modal-body label { display: block; margin-bottom: 0.5rem; font-weight: 600; opacity: 0.9; }
        .modal-body input, .modal-body textarea, .modal-body select { width: 100%; padding: 0.8rem; margin-bottom: 1rem; border-radius: 8px; border: 1px solid var(--tool-card-background); background-color: var(--background-color); color: var(--text-color); font-family: var(--font-family); font-size: 1rem; transition: border-color 0.3s, box-shadow 0.3s; }
        .modal-body input:focus, .modal-body textarea:focus, .modal-body select:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 3px var(--accent-shadow); }
        .modal-body button { background-color: var(--accent-color); color: var(--heading-color); border: none; padding: 0.8rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 0.5rem; margin-right: 0.5rem; }
        .modal-body button:hover { background-color: var(--button-hover-color); transform: translateY(-2px); }
        .modal-body button:disabled { background-color: #555; cursor: not-allowed; }
        .result-area { margin-top: 1rem; padding: 1rem; background-color: var(--background-color); border-radius: 8px; border: 1px solid var(--tool-card-background); white-space: pre-wrap; word-wrap: break-word; }
        .footer-section { text-align: center; padding: 3rem 1rem; }
        #openArticleBtn { background-color: transparent; color: var(--accent-color); border: 2px solid var(--accent-color); padding: 0.8rem 1.8rem; border-radius: 50px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; font-size: 1rem; }
        #openArticleBtn:hover { background-color: var(--accent-color); color: var(--header-background); box-shadow: 0 4px 20px var(--accent-shadow); transform: translateY(-3px); }
        .modal-alert { margin-top: 1rem; padding: 0.75rem; border-radius: 5px; font-weight: bold; color: white; display: none; }
        .modal-alert.success { background-color: #28a745; }
        .modal-alert.error { background-color: #dc3545; }
        .modal-alert.info { background-color: #17a2b8; }
        .tabs { display:flex; margin-bottom:1rem; border-bottom:1px solid var(--tool-card-background); }
        .tab-button { background:none; border:none; color: var(--text-color); padding: 0.75rem 1rem; cursor:pointer; font-size: 1rem; font-family: var(--font-family); transition: background-color 0.3s, color 0.3s; }
        .tab-button.active { background-color: var(--accent-color); color: var(--header-background); border-bottom: 2px solid var(--accent-color); font-weight: bold; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) { 
            header h1 { font-size: 2.2rem; } 
            .modal-content { width: 95%; margin: 10% auto; padding: 20px; } 
            .header-content { flex-direction: column; }
        }
    </style>
</head>
<body>
    <header>
  <div class="header-content">
    <img src="https://cdn.jsdelivr.net/gh/OnePageTools/One-Page-Tools/logo.jpg.png" alt="One Page Tools Logo" class="logo">
    <div>
      <h1>One Page Tools</h1>
      <p style="opacity: 0.8;">Your Ultimate Collection of 30+ Free Online Utilities</p>
    </div>
  </div>
</header>

    <main>
        <div class="tool-grid"></div>
    </main>
    
    <div class="footer-section">
        <button id="openArticleBtn">What are these tools & how to use them?</button>
    </div>

    <div id="toolModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modalTitle">Tool Title</h2>
            <div id="modalBody" class="modal-body"></div>
            <div id="modalAlert" class="modal-alert"></div>
        </div>
    </div>
    
    <div id="articleModal" class="modal">
        <div class="modal-content article-modal-content">
            <span class="close-button" id="closeArticleModal">&times;</span>
            <article id="toolsArticle"></article>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const toolGrid = document.querySelector('.tool-grid');
        const toolModal = document.getElementById('toolModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const modalAlert = document.getElementById('modalAlert');
        const closeToolButton = toolModal.querySelector('.close-button');
        const articleModal = document.getElementById('articleModal');
        const openArticleBtn = document.getElementById('openArticleBtn');
        const closeArticleBtn = document.getElementById('closeArticleModal');

        const tools = [
            { id: 'ageCalculator', title: 'Age Calculator', description: 'Calculate exact age from date of birth.', icon: 'fas fa-birthday-cake' },
            { id: 'audioConverter', title: 'Audio Converter', description: 'Convert various audio files to the WAV format.', icon: 'fas fa-file-audio' },
            { id: 'audioTrimmer', title: 'Audio Trimmer', description: 'Upload, trim, and export a segment of an audio file.', icon: 'fas fa-cut' },
            { id: 'base64EncoderDecoder', title: 'Base64 Encoder/Decoder', description: 'Encode or decode text to and from Base64.', icon: 'fas fa-exchange-alt' },
            { id: 'bmiCalculator', title: 'BMI Calculator', description: 'Calculate your Body Mass Index.', icon: 'fas fa-weight' },
            { id: 'caseConverter', title: 'Case Converter', description: 'Convert text to UPPERCASE, lowercase, Title Case, etc.', icon: 'fas fa-font' },
            { id: 'colorPicker', title: 'Color Picker', description: 'Pick colors and get their HEX, RGB, and HSL values.', icon: 'fas fa-palette' },
            { id: 'countdownToDate', title: 'Countdown to Date', description: 'Set a timer for an upcoming event or date.', icon: 'fas fa-hourglass-half' },
            { id: 'emiCalculator', title: 'EMI Calculator', description: 'Calculate Equated Monthly Installment for loans.', icon: 'fas fa-rupee-sign' },
            { id: 'findAndReplace', title: 'Find and Replace', description: 'Easily find and replace words in your text.', icon: 'fas fa-search' },
            { id: 'hashGenerator', title: 'Hash Generator', description: 'Generate MD5, SHA-1, SHA-256 hashes.', icon: 'fas fa-hashtag' },
            { id: 'imageCompressor', title: 'Image Compressor', description: 'Reduce image file size with quality settings.', icon: 'fas fa-compress-arrows-alt' },
            { id: 'imageConverter', title: 'Image Converter', description: 'Convert between JPG, PNG, and WEBP formats.', icon: 'fas fa-sync-alt' },
            { id: 'imageCropper', title: 'Image Cropper', description: 'Upload and crop an image with a visual preview.', icon: 'fas fa-crop-alt' },
            { id: 'imageResizer', title: 'Image Resizer', description: 'Resize images to specific dimensions.', icon: 'fas fa-expand-arrows-alt' },
            { id: 'jsonFormatter', title: 'JSON Formatter', description: 'Format, validate, and beautify JSON data.', icon: 'fas fa-code' },
            { id: 'loremIpsumGenerator', title: 'Lorem Ipsum Generator', description: 'Generate placeholder text for your designs.', icon: 'fas fa-paragraph' },
            { id: 'markdownPreviewer', title: 'Markdown Previewer', description: 'Write in Markdown and see a real-time preview.', icon: 'fab fa-markdown' },
            { id: 'passwordGenerator', title: 'Password Generator', description: 'Generate strong, secure, random passwords.', icon: 'fas fa-key' },
            { id: 'qrCodeGenerator', title: 'QR Code Generator', description: 'Generate downloadable QR codes from any text or URL.', icon: 'fas fa-qrcode' },
            { id: 'randomNumberGenerator', title: 'Random Number Generator', description: 'Generate a random number in a given range.', icon: 'fas fa-random' },
            { id: 'sipCalculator', title: 'SIP Calculator', description: 'Estimate the future value of SIP investments.', icon: 'fas fa-chart-line' },
            { id: 'speechToText', title: 'Speech to Text', description: 'Convert your voice from a microphone into text.', icon: 'fas fa-microphone' },
            { id: 'textToSpeech', title: 'Text to Speech', description: 'Convert text into spoken audio in your browser.', icon: 'fas fa-volume-up' },
            { id: 'timerStopwatch', title: 'Timer & Stopwatch', description: 'A simple countdown timer and stopwatch with laps.', icon: 'fas fa-stopwatch' },
            { id: 'tipCalculator', title: 'Tip Calculator', description: 'Calculate tip and split the bill among friends.', icon: 'fas fa-concierge-bell' },
            { id: 'unitConverter', title: 'Unit Converter', description: 'Convert between various units of measurement.', icon: 'fas fa-balance-scale-right' },
            { id: 'urlEncoderDecoder', title: 'URL Encoder/Decoder', description: 'Encode or decode URLs for safe web use.', icon: 'fas fa-link' },
            { id: 'videoConverter', title: 'Video Converter', description: 'Convert video formats (e.g., MP4 to WebM).', icon: 'fas fa-video' },
            { id: 'wordCounter', title: 'Word Counter', description: 'Count words, characters, sentences, and reading time.', icon: 'fas fa-file-word' }
        ];

        function openToolModal(tool) {
            modalTitle.textContent = tool.title;
            modalBody.innerHTML = '';
            hideAlert();
            const toolFunction = toolInitializers[tool.id];
            if (toolFunction) { toolFunction(modalBody); } 
            else { modalBody.innerHTML = '<p>An error occurred. This tool could not be loaded.</p>'; }
            toolModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        function closeToolModal() {
            toolModal.style.display = 'none';
            document.body.style.overflow = 'auto';
            if (window.currentToolCleanup) { window.currentToolCleanup(); window.currentToolCleanup = null; }
        }
        function openArticleModal() {
            const articleContent = `<h2>Welcome to One Page Tools</h2> <p>In today's fast-paced digital world, efficiency and convenience are paramount. <strong>One Page Tools</strong> is a curated collection of essential, free-to-use online utilities designed to simplify your tasks and boost your productivity, all from a single page.</p> <h3>Why Choose One Page Tools?</h3> <ul> <li><strong>Completely Free & No Sign-up:</strong> All tools are available at no cost, without any registration.</li> <li><strong>Privacy First:</strong> Most tools work entirely on your computer (client-side). Your files and data are not uploaded to any server, ensuring your privacy.</li> <li><strong>User-Friendly & Fast:</strong> Our clean, minimalistic design makes it easy to find and use the tool you need, on any device.</li> </ul>`;
            articleModal.querySelector('#toolsArticle').innerHTML = articleContent;
            articleModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        function closeArticleModal() { articleModal.style.display = 'none'; document.body.style.overflow = 'auto'; }
        function showAlert(message, type = 'info') { modalAlert.textContent = message; modalAlert.className = `modal-alert ${type}`; modalAlert.style.display = 'block'; setTimeout(hideAlert, 5000); }
        function hideAlert() { modalAlert.style.display = 'none'; }
        
        openArticleBtn.onclick = openArticleModal;
        closeArticleBtn.onclick = closeArticleModal;
        closeToolButton.onclick = closeToolModal;
        window.onclick = (event) => {
            if (event.target === toolModal) closeToolModal();
            if (event.target === articleModal) closeArticleModal();
        };

        tools.sort((a, b) => a.title.localeCompare(b.title)).forEach((tool, index) => {
            const card = document.createElement('div');
            card.className = 'tool-card';
            card.style.animationDelay = `${index * 0.02}s`;
            card.innerHTML = `<div class="icon-container"><i class="${tool.icon}"></i></div><h2>${tool.title}</h2><p>${tool.description}</p><button class="tool-button">Open Tool</button>`;
            card.querySelector('.tool-button').addEventListener('click', () => openToolModal(tool));
            toolGrid.appendChild(card);
        });
        
        const toolInitializers = {
            imageConverter: (container) => {
                container.innerHTML = `<input type="file" id="imgConvFile" accept="image/jpeg,image/png,image/webp"><label for="imgConvFormat" style="margin-top:1rem;">Convert to:</label><select id="imgConvFormat"><option value="image/jpeg">JPEG</option><option value="image/png">PNG</option><option value="image/webp">WEBP</option></select><button id="imgConvButton">Convert & Download</button><img id="imagePreview" src="#" alt="Image Preview" style="display:none;max-width:100%;margin-top:1rem;">`;
                const fileInput = container.querySelector('#imgConvFile'), formatSelect = container.querySelector('#imgConvFormat'), convertButton = container.querySelector('#imgConvButton'), preview = container.querySelector('#imagePreview'); let originalFileName = 'converted_image';
                fileInput.onchange = (e) => { if (e.target.files && e.target.files[0]) { originalFileName = e.target.files[0].name.split('.')[0] || 'image'; const reader = new FileReader(); reader.onload = (event) => { preview.src = event.target.result; preview.style.display = 'block'; }; reader.readAsDataURL(e.target.files[0]); } };
                convertButton.onclick = () => { if (!fileInput.files || fileInput.files.length === 0) { showAlert('Please select an image file first.', 'error'); return; } const targetFormat = formatSelect.value, targetExtension = targetFormat.split('/')[1]; showAlert('Processing...', 'info'); const img = new Image(); img.onload = () => { const canvas = document.createElement('canvas'); canvas.width = img.width; canvas.height = img.height; canvas.getContext('2d').drawImage(img, 0, 0); canvas.toBlob((blob) => { if (!blob) { showAlert(`Error converting to ${targetFormat}.`, 'error'); return; } const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `${originalFileName}_converted.${targetExtension}`; document.body.appendChild(a); a.click(); document.body.removeChild(a); showAlert('Conversion successful!', 'success'); }, targetFormat, 0.9); }; img.src = preview.src; };
            },
            imageCompressor: (container) => {
                container.innerHTML = `<input type="file" id="imgCompFile" accept="image/jpeg,image/png"><label for="imgCompQuality" style="margin-top:1rem;">Quality (0.1 - 1.0 for JPEG):</label><input type="number" id="imgCompQuality" value="0.7" min="0.1" max="1.0" step="0.1"><button id="imgCompButton">Compress & Download</button><div id="compressionInfo" class="result-area" style="display:none;"></div><img id="imagePreviewComp" src="#" alt="Image Preview" style="display:none; max-width:100%; margin-top:1rem;">`;
                const fileInput = container.querySelector('#imgCompFile'), qualityInput = container.querySelector('#imgCompQuality'), compressButton = container.querySelector('#imgCompButton'), compressionInfo = container.querySelector('#compressionInfo'), preview = container.querySelector('#imagePreviewComp'); let originalFileName = 'compressed_image';
                fileInput.onchange = (e) => { if (e.target.files && e.target.files[0]) { originalFileName = e.target.files[0].name.split('.')[0] || 'image'; const reader = new FileReader(); reader.onload = (event) => { preview.src = event.target.result; preview.style.display = 'block'; }; reader.readAsDataURL(e.target.files[0]); } };
                compressButton.onclick = () => { if (!fileInput.files || fileInput.files.length === 0) { showAlert('Please select an image file.', 'error'); return; } const file = fileInput.files[0], quality = parseFloat(qualityInput.value), originalSize = (file.size / 1024).toFixed(2); const img = new Image(); img.onload = () => { const canvas = document.createElement('canvas'); canvas.width = img.width; canvas.height = img.height; canvas.getContext('2d').drawImage(img, 0, 0); const outputFormat = file.type === 'image/png' ? 'image/png' : 'image/jpeg'; const extension = outputFormat.split('/')[1]; canvas.toBlob((blob) => { if (blob) { const compressedSize = (blob.size / 1024).toFixed(2); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `${originalFileName}_compressed.${extension}`; document.body.appendChild(a); a.click(); document.body.removeChild(a); compressionInfo.innerHTML = `Original Size: ${originalSize} KB<br>Compressed Size: ${compressedSize} KB<br>Reduction: ${((1 - compressedSize / originalSize) * 100).toFixed(2)}%`; compressionInfo.style.display = 'block'; showAlert('Compression successful!', 'success'); } }, outputFormat, outputFormat === 'image/jpeg' ? quality : undefined); }; img.src = preview.src; };
            },
            imageResizer: (container) => {
                container.innerHTML = `<input type="file" id="resizeFile" accept="image/*"><div id="resizeControls" style="display:none; margin-top:1rem;"><div style="display:flex; gap: 15px; align-items: center; flex-wrap: wrap;"><div><label for="resizeWidth">Width (px):</label><input type="number" id="resizeWidth" min="1"></div><div><label for="resizeHeight">Height (px):</label><input type="number" id="resizeHeight" min="1"></div><div><input type="checkbox" id="aspectLock" checked><label for="aspectLock">Lock Aspect Ratio</label></div></div><button id="resizeBtn" style="margin-top:1rem;">Resize & Download</button></div><img id="resizePreview" src="#" alt="Preview" style="display:none; max-width:100%; margin-top:1rem; border:1px solid var(--accent-color);">`;
                const fileInput=container.querySelector("#resizeFile"),controls=container.querySelector("#resizeControls"),widthInput=container.querySelector("#resizeWidth"),heightInput=container.querySelector("#resizeHeight"),aspectLock=container.querySelector("#aspectLock"),resizeBtn=container.querySelector("#resizeBtn"),preview=container.querySelector("#resizePreview");let originalWidth,originalHeight,originalFileName;fileInput.onchange=e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0];originalFileName=t.name.split(".")[0];const o=new FileReader;o.onload=e=>{preview.src=e.target.result;preview.style.display="block";const t=new Image;t.onload=()=>{originalWidth=t.width,originalHeight=t.height,widthInput.value=originalWidth,heightInput.value=originalHeight,controls.style.display="block"};t.src=e.target.result};o.readAsDataURL(t)}};widthInput.oninput=()=>{if(aspectLock.checked){heightInput.value=Math.round(widthInput.value/originalWidth*originalHeight)}};heightInput.oninput=()=>{if(aspectLock.checked){widthInput.value=Math.round(heightInput.value/originalHeight*originalWidth)}};resizeBtn.onclick=()=>{const e=parseInt(widthInput.value),t=parseInt(heightInput.value);if(!e||!t||e<=0||t<=0)return void showAlert("Please enter valid dimensions.","error");const o=document.createElement("canvas");o.width=e,o.height=t;const n=o.getContext("2d"),a=new Image;a.onload=()=>{n.drawImage(a,0,0,e,t);o.toBlob(e=>{const t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download=`${originalFileName}_resized.png`;document.body.appendChild(o),o.click(),document.body.removeChild(o),showAlert("Image resized successfully!","success")},"image/png")},a.src=preview.src};
            },
            imageCropper: (container) => {
                container.innerHTML = `<input type="file" id="cropFile" accept="image/*"><p>Upload an image. Click and drag to create a selection.</p><div id="cropContainer" style="position: relative; margin-top: 1rem; max-width: 100%; cursor:crosshair;"><canvas id="cropCanvas"></canvas></div><button id="cropBtn" style="display:none; margin-top: 1rem;">Crop & Download</button>`;
                const fileInput = container.querySelector('#cropFile'), canvas = container.querySelector('#cropCanvas'), cropBtn = container.querySelector('#cropBtn'), ctx = canvas.getContext('2d'); let img, selection = {}, drag = false, originalFileName = 'cropped';
                fileInput.onchange = (e) => { if (e.target.files && e.target.files[0]) { originalFileName = e.target.files[0].name.split('.')[0]; const reader = new FileReader(); reader.onload = (event) => { img = new Image(); img.onload = () => { const MAX_WIDTH = 500; let scale = MAX_WIDTH / img.width; if (img.width < MAX_WIDTH) scale = 1; canvas.width = img.width * scale; canvas.height = img.height * scale; ctx.drawImage(img, 0, 0, canvas.width, canvas.height); cropBtn.style.display = 'inline-block'; }; img.src = event.target.result; }; reader.readAsDataURL(e.target.files[0]); } };
                function reDraw() { ctx.clearRect(0, 0, canvas.width, canvas.height); ctx.drawImage(img, 0, 0, canvas.width, canvas.height); if (selection.w) { ctx.strokeStyle = 'red'; ctx.lineWidth = 2; ctx.strokeRect(selection.x, selection.y, selection.w, selection.h); } }
                canvas.onmousedown = (e) => { selection.x = e.offsetX; selection.y = e.offsetY; selection.w = 0; selection.h = 0; drag = true; };
                canvas.onmousemove = (e) => { if (drag) { selection.w = e.offsetX - selection.x; selection.h = e.offsetY - selection.y; reDraw(); } };
                canvas.onmouseup = () => { drag = false; };
                cropBtn.onclick = () => { if (!selection.w || !selection.h) { showAlert('Please make a selection to crop.', 'error'); return; } const scale = img.width / canvas.width; const tempCanvas = document.createElement('canvas'); tempCanvas.width = Math.abs(selection.w * scale); tempCanvas.height = Math.abs(selection.h * scale); const tempCtx = tempCanvas.getContext('2d'); const sx = selection.w > 0 ? selection.x : selection.x + selection.w; const sy = selection.h > 0 ? selection.y : selection.y + selection.h; tempCtx.drawImage(img, sx * scale, sy * scale, Math.abs(selection.w * scale), Math.abs(selection.h * scale), 0, 0, Math.abs(selection.w * scale), Math.abs(selection.h * scale)); const a = document.createElement('a'); a.href = tempCanvas.toDataURL(); a.download = `${originalFileName}_cropped.png`; a.click(); showAlert('Image cropped!', 'success'); };
            },
            ageCalculator: (container) => {
                container.innerHTML = `<label for="birthDate">Enter your Date of Birth:</label><input type="date" id="birthDate"><button id="calculateAgeBtn" style="margin-top:1rem;">Calculate Age</button><div id="ageResult" class="result-area" style="display:none; text-align:center;"></div>`;
                const birthDateInput = container.querySelector('#birthDate'), calculateBtn = container.querySelector('#calculateAgeBtn'), ageResultDiv = container.querySelector('#ageResult');
                calculateBtn.onclick = () => { const birthDateString = birthDateInput.value; if (!birthDateString) { showAlert('Please enter your date of birth.', 'error'); return; } const birthDate = new Date(birthDateString), today = new Date(); if (birthDate > today) { showAlert('Birth date cannot be in the future.', 'error'); return; } let years = today.getFullYear() - birthDate.getFullYear(), months = today.getMonth() - birthDate.getMonth(), days = today.getDate() - birthDate.getDate(); if (days < 0) { months--; days += new Date(today.getFullYear(), today.getMonth(), 0).getDate(); } if (months < 0) { years--; months += 12; } ageResultDiv.innerHTML = `You are: <br><strong style="font-size:1.5em">${years}</strong> years, <strong style="font-size:1.5em">${months}</strong> months, and <strong style="font-size:1.5em">${days}</strong> days old.`; ageResultDiv.style.display = 'block'; };
            },
            bmiCalculator: (container) => {
                container.innerHTML = `<label for="bmiWeight">Weight (kg):</label><input type="number" id="bmiWeight" placeholder="e.g., 70" min="0"><label for="bmiHeight">Height (cm):</label><input type="number" id="bmiHeight" placeholder="e.g., 175" min="0"><button id="calculateBmiBtn">Calculate BMI</button><div id="bmiResult" class="result-area" style="display:none; text-align:center;"></div>`;
                const weightInput = container.querySelector('#bmiWeight'), heightInput = container.querySelector('#bmiHeight'), calculateBtn = container.querySelector('#calculateBmiBtn'), resultDiv = container.querySelector('#bmiResult');
                calculateBtn.onclick = () => { const weight = parseFloat(weightInput.value), heightCm = parseFloat(heightInput.value); if (isNaN(weight) || isNaN(heightCm) || weight <= 0 || heightCm <= 0) { showAlert('Please enter valid positive numbers for weight and height.', 'error'); return; } const heightM = heightCm / 100, bmi = weight / (heightM * heightM); let category = '', color = 'var(--text-color)'; if (bmi < 18.5) { category = 'Underweight'; color = '#3498db'; } else if (bmi < 24.9) { category = 'Normal weight'; color = '#2ecc71'; } else if (bmi < 29.9) { category = 'Overweight'; color = '#f1c40f'; } else { category = 'Obesity'; color = '#e74c3c'; } resultDiv.innerHTML = `Your BMI: <strong style="font-size:1.5em;">${bmi.toFixed(2)}</strong><br>Category: <strong style="color:${color};">${category}</strong>`; resultDiv.style.display = 'block'; };
            },
            emiCalculator: (container) => {
                container.innerHTML = `<label for="loanAmount">Loan Amount (₹):</label><input type="number" id="loanAmount" placeholder="e.g., 100000" min="0"><label for="interestRate">Annual Interest Rate (%):</label><input type="number" id="interestRate" placeholder="e.g., 10.5" min="0" step="0.01"><label for="loanTenure">Loan Tenure (months):</label><input type="number" id="loanTenure" placeholder="e.g., 12" min="1"><button id="calculateEmiBtn">Calculate EMI</button><div id="emiResult" class="result-area" style="display:none;"></div>`;
                const amountInput=container.querySelector("#loanAmount"),rateInput=container.querySelector("#interestRate"),tenureInput=container.querySelector("#loanTenure"),calculateBtn=container.querySelector("#calculateEmiBtn"),resultDiv=container.querySelector("#emiResult");calculateBtn.onclick=()=>{const e=parseFloat(amountInput.value),t=parseFloat(rateInput.value),o=parseInt(tenureInput.value);if(isNaN(e)||isNaN(t)||isNaN(o)||e<=0||t<0||o<=0)return void showAlert("Please enter valid positive numbers.","error");if(0===t){const t=e/o;return resultDiv.innerHTML=`Monthly EMI: <strong>₹${t.toFixed(2)}</strong><br>Total Interest: <strong>₹0.00</strong><br>Total Payment: <strong>₹${e.toFixed(2)}</strong>`,void(resultDiv.style.display="block")}const n=t/1200,a=Math.pow(1+n,o),l=(e*n*a)/(a-1),i=l*o,r=i-e;resultDiv.innerHTML=`Monthly EMI: <strong>₹${l.toFixed(2)}</strong><br>Total Interest Payable: <strong>₹${r.toFixed(2)}</strong><br>Total Payment: <strong>₹${i.toFixed(2)}</strong>`,resultDiv.style.display="block"};
            },
            sipCalculator: (container) => {
                container.innerHTML = `<label for="monthlyInvestment">Monthly Investment (₹):</label><input type="number" id="monthlyInvestment" placeholder="e.g., 5000" min="0"><label for="expectedReturnRate">Expected Annual Return Rate (%):</label><input type="number" id="expectedReturnRate" placeholder="e.g., 12" min="0" step="0.01"><label for="investmentDuration">Investment Duration (years):</label><input type="number" id="investmentDuration" placeholder="e.g., 10" min="1"><button id="calculateSipBtn">Calculate Future Value</button><div id="sipResult" class="result-area" style="display:none;"></div>`;
                const monthlyInvestmentInput=container.querySelector("#monthlyInvestment"),returnRateInput=container.querySelector("#expectedReturnRate"),durationInput=container.querySelector("#investmentDuration"),calculateBtn=container.querySelector("#calculateSipBtn"),resultDiv=container.querySelector("#sipResult");calculateBtn.onclick=()=>{const e=parseFloat(monthlyInvestmentInput.value),t=parseFloat(returnRateInput.value),o=parseInt(durationInput.value);if(isNaN(e)||isNaN(t)||isNaN(o)||e<=0||t<0||o<=0)return void showAlert("Please enter valid inputs.","error");const n=12*o,a=t/12/100,l=0===a?e*n:e*((Math.pow(1+a,n)-1)/a)*(1+a),i=e*n,r=l-i;resultDiv.innerHTML=`Invested Amount: <strong>₹${i.toFixed(2)}</strong><br>Estimated Returns: <strong>₹${r.toFixed(2)}</strong><br>Total Future Value: <strong>₹${l.toFixed(2)}</strong>`,resultDiv.style.display="block"};
            },
            tipCalculator: (container) => {
                container.innerHTML = `<label for="billAmount">Bill Amount:</label><input type="number" id="billAmount" placeholder="e.g., 1000" min="0"><label for="tipPercent" style="margin-top:1rem;">Tip %:</label><input type="range" id="tipPercent" min="0" max="50" value="15" step="1" style="width:100%;"><p style="text-align:center; font-weight:bold;">Tip: <span id="tipPercentValue">15</span>%</p><label for="numPeople">Number of People:</label><input type="number" id="numPeople" value="1" min="1"><button id="calculateTipBtn" style="margin-top:1rem;">Calculate</button><div id="tipResult" class="result-area" style="display:none; margin-top:1rem; text-align:center;"></div>`;
                const billInput=container.querySelector("#billAmount"),tipInput=container.querySelector("#tipPercent"),tipValue=container.querySelector("#tipPercentValue"),peopleInput=container.querySelector("#numPeople"),calculateBtn=container.querySelector("#calculateTipBtn"),resultDiv=container.querySelector("#tipResult");tipInput.oninput=()=>{tipValue.textContent=tipInput.value};calculateBtn.onclick=()=>{const e=parseFloat(billInput.value),t=parseInt(tipInput.value),o=parseInt(peopleInput.value);if(isNaN(e)||e<=0||isNaN(o)||o<=0)return void showAlert("Please enter a valid bill amount and number of people.","error");const n=e*t/100,a=e+n,l=n/o,i=a/o;resultDiv.innerHTML=`Tip per Person: <strong>₹${l.toFixed(2)}</strong><br>Total per Person: <strong>₹${i.toFixed(2)}</strong><hr style="margin:10px 0; border-color: var(--tool-card-background);"><br>Total Bill (with Tip): <strong>₹${a.toFixed(2)}</strong>`,resultDiv.style.display="block"};
            },
            unitConverter: (container) => {
                const units = { length: { name: "Length", items: { Meter: 1, Kilometer: 1e3, Mile: 1609.34, Foot: .3048, Inch: .0254 } }, weight: { name: "Weight/Mass", items: { Kilogram: 1, Gram: .001, Pound: .453592, Ounce: .0283495 } }, temperature: { name: "Temperature", items: { Celsius: "c", Fahrenheit: "f", Kelvin: "k" } } };
                container.innerHTML = `<label for="ucCategory">Category:</label><select id="ucCategory"></select><div style="display:flex; gap:10px; margin-top:1rem; align-items:flex-end;"><div style="flex:2"><label for="ucInputValue">Value:</label><input type="number" id="ucInputValue" value="1"></div><div style="flex:3"><label for="ucFromUnit">From:</label><select id="ucFromUnit"></select></div><div style="font-size:1.5rem; padding-bottom:0.5rem;">⇄</div><div style="flex:3"><label for="ucToUnit">To:</label><select id="ucToUnit"></select></div></div><div id="ucResult" class="result-area" style="margin-top:1rem; font-weight:bold; font-size:1.2rem; text-align:center;"></div>`;
                const categorySelect = container.querySelector('#ucCategory'), fromUnitSelect = container.querySelector('#ucFromUnit'), toUnitSelect = container.querySelector('#ucToUnit'), valueInput = container.querySelector('#ucInputValue'), resultDiv = container.querySelector('#ucResult');
                function populateCategories() { for (const categoryKey in units) { const option = document.createElement('option'); option.value = categoryKey; option.textContent = units[categoryKey].name; categorySelect.appendChild(option); } }
                function populateUnitOptions(categoryKey) { const unitSet = units[categoryKey].items; fromUnitSelect.innerHTML = ''; toUnitSelect.innerHTML = ''; for (const unit in unitSet) { const option1 = document.createElement('option'); option1.value = unit; option1.textContent = unit; fromUnitSelect.appendChild(option1); const option2 = document.createElement('option'); option2.value = unit; option2.textContent = unit; toUnitSelect.appendChild(option2); } toUnitSelect.selectedIndex = 1; }
                function convertUnits() { const categoryKey = categorySelect.value, fromUnit = fromUnitSelect.value, toUnit = toUnitSelect.value, inputValue = parseFloat(valueInput.value); if (isNaN(inputValue)) { resultDiv.textContent = 'Invalid input'; return; } let result; const unitFactors = units[categoryKey].items; if (categoryKey === 'temperature') { let tempC; if (fromUnit === 'Celsius') tempC = inputValue; else if (fromUnit === 'Fahrenheit') tempC = (inputValue - 32) * 5/9; else if (fromUnit === 'Kelvin') tempC = inputValue - 273.15; if (toUnit === 'Celsius') result = tempC; else if (toUnit === 'Fahrenheit') result = (tempC * 9/5) + 32; else if (toUnit === 'Kelvin') result = tempC + 273.15; } else { const baseValue = inputValue * unitFactors[fromUnit]; result = baseValue / unitFactors[toUnit]; } resultDiv.textContent = `${inputValue} ${fromUnit} = ${result.toFixed(4)} ${toUnit}`; }
                categorySelect.onchange = () => { populateUnitOptions(categorySelect.value); convertUnits(); };
                fromUnitSelect.onchange = convertUnits; toUnitSelect.onchange = convertUnits; valueInput.oninput = convertUnits;
                populateCategories(); populateUnitOptions(categorySelect.value); convertUnits();
            },
            wordCounter: (container) => {
                container.innerHTML = `<textarea id="wcText" placeholder="Paste or type your text here..." rows="8"></textarea><div id="wcResult" class="result-area" style="margin-top:1rem;">Words: <strong id="wcWords">0</strong><br>Characters: <strong id="wcChars">0</strong><br>Sentences: <strong id="wcSentences">0</strong></div>`;
                const textArea=container.querySelector("#wcText"),wordsSpan=container.querySelector("#wcWords"),charsSpan=container.querySelector("#wcChars"),sentencesSpan=container.querySelector("#wcSentences");textArea.oninput=()=>{const e=textArea.value,t=e.match(/\b[-'\w]+\b/g),o=t?t.length:0,n=e.length,a=e.match(/[^.!?]+[.!?]+(\s|$)/g),l=a?a.length:e.trim()?1:0;wordsSpan.textContent=o,charsSpan.textContent=n,sentencesSpan.textContent=l};
            },
            caseConverter: (container) => {
                container.innerHTML = `<textarea id="caseInput" placeholder="Enter your text here..." rows="6"></textarea><div style="margin-top:1rem; display:flex; flex-wrap:wrap; gap:10px;"><button id="caseUpper">UPPER CASE</button><button id="caseLower">lower case</button><button id="caseTitle">Title Case</button><button id="caseSentence">Sentence case</button></div>`;
                const inputArea=container.querySelector("#caseInput");container.querySelector("#caseUpper").onclick=()=>{inputArea.value=inputArea.value.toUpperCase()},container.querySelector("#caseLower").onclick=()=>{inputArea.value=inputArea.value.toLowerCase()},container.querySelector("#caseTitle").onclick=()=>{inputArea.value=inputArea.value.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},container.querySelector("#caseSentence").onclick=()=>{inputArea.value=inputArea.value.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g,e=>e.toUpperCase())};
            },
            findAndReplace: (container) => {
                container.innerHTML = `<label>Find and Replace in this Text:</label><textarea id="frInput" rows="5" placeholder="Paste your text here..."></textarea><div style="display:flex; gap:15px; margin-top:1rem;"><input type="text" id="frFind" placeholder="Find this..."><input type="text" id="frReplace" placeholder="Replace with this..."></div><div style="margin-top:1rem;"><input type="checkbox" id="frCaseSensitive"> <label for="frCaseSensitive">Case Sensitive</label></div><button id="frReplaceBtn">Replace All</button><label style="margin-top:1rem; display:block;">Result:</label><textarea id="frOutput" rows="5" readonly></textarea>`;
                const inputArea=container.querySelector("#frInput"),findInput=container.querySelector("#frFind"),replaceInput=container.querySelector("#frReplace"),caseCheck=container.querySelector("#frCaseSensitive"),replaceBtn=container.querySelector("#frReplaceBtn"),outputArea=container.querySelector("#frOutput");replaceBtn.onclick=()=>{const e=inputArea.value,t=findInput.value,o=replaceInput.value;if(!t)return void showAlert("The 'Find' field cannot be empty.","error");const n=caseCheck.checked?"g":"gi",a=new RegExp(t,n);outputArea.value=e.replace(a,o),showAlert("Replacement complete!","success")};
            },
            loremIpsumGenerator: (container) => {
                container.innerHTML = `<div><label for="loremCount">Number of Paragraphs:</label><input type="number" id="loremCount" value="3" min="1" max="50"></div><button id="generateLoremBtn" style="margin-top:1rem;">Generate Text</button><label for="loremOutput" style="margin-top:1rem; display:block;">Generated Text:</label><textarea id="loremOutput" rows="8" readonly></textarea>`;
                const countInput=container.querySelector("#loremCount"),generateBtn=container.querySelector("#generateLoremBtn"),outputArea=container.querySelector("#loremOutput"),loremWords=["lorem","ipsum","dolor","sit","amet","consectetur","adipiscing","elit","praesent","interdum","dictum","mi","non","egestas","in","hac","habitasse","platea","dictumst","vivamus"];function generateLorem(e){let t="";for(let o=0;o<e;o++){let e=Math.floor(4*Math.random())+5,n="";for(let t=0;t<e;t++){let e=Math.floor(8*Math.random())+8,o="";for(let t=0;t<e;t++)o+=loremWords[Math.floor(Math.random()*loremWords.length)]+" ";o=o.charAt(0).toUpperCase()+o.slice(1).trim()+". ",n+=o}t+=n.trim()+"\n\n"}return t.trim()}generateBtn.onclick=()=>{const e=parseInt(countInput.value);e>0&&e<=50?(outputArea.value=generateLorem(e),showAlert("Text generated!","success")):showAlert("Please enter a number between 1 and 50.","error")};
            },
            qrCodeGenerator: (container) => {
                container.innerHTML = `<label for="qrText">Text or URL for QR Code:</label><textarea id="qrText" placeholder="https://google.com"></textarea><button id="generateQrBtn" style="margin-top:1rem;">Generate QR Code</button><div style="text-align:center;"><div id="qrCodeContainer" style="background-color: white; padding: 10px; display: inline-block; margin: 1rem auto;"></div></div>`;
                const textInput = container.querySelector('#qrText'), generateBtn = container.querySelector('#generateQrBtn'), qrContainer = container.querySelector('#qrCodeContainer');
                generateBtn.onclick = () => { const text = textInput.value.trim(); if (!text) { showAlert('Please enter text or URL.', 'error'); return; } qrContainer.innerHTML = ''; new QRCode(qrContainer, { text: text, width: 200, height: 200 }); showAlert('QR Code generated!', 'success'); };
            },
            passwordGenerator: (container) => {
                container.innerHTML = `<label for="passLength">Password Length:</label><input type="number" id="passLength" value="16" min="8" max="128"><div style="margin-top:1rem;"><input type="checkbox" id="incUppercase" checked> <label>Uppercase</label><br><input type="checkbox" id="incLowercase" checked> <label>Lowercase</label><br><input type="checkbox" id="incNumbers" checked> <label>Numbers</label><br><input type="checkbox" id="incSymbols" checked> <label>Symbols</label></div><button id="generatePassBtn" style="margin-top:1rem;">Generate Password</button><div style="margin-top:1rem; display:flex;"><input type="text" id="generatedPassword" readonly style="flex-grow:1;"><button id="copyPassBtn">Copy</button></div>`;
                const lengthInput=container.querySelector("#passLength"),uppercaseCheck=container.querySelector("#incUppercase"),lowercaseCheck=container.querySelector("#incLowercase"),numbersCheck=container.querySelector("#incNumbers"),symbolsCheck=container.querySelector("#incSymbols"),generateBtn=container.querySelector("#generatePassBtn"),passwordOutput=container.querySelector("#generatedPassword"),copyBtn=container.querySelector("#copyPassBtn"),charSets={uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",lowercase:"abcdefghijklmnopqrstuvwxyz",numbers:"0123456789",symbols:"!@#$%^&*()_+-=[]{}|;:,.<>?"};generateBtn.onclick=()=>{const e=parseInt(lengthInput.value);let t="",o="";if(uppercaseCheck.checked&&(t+=charSets.uppercase,o+=charSets.uppercase[Math.floor(Math.random()*charSets.uppercase.length)]),lowercaseCheck.checked&&(t+=charSets.lowercase,o+=charSets.lowercase[Math.floor(Math.random()*charSets.lowercase.length)]),numbersCheck.checked&&(t+=charSets.numbers,o+=charSets.numbers[Math.floor(Math.random()*charSets.numbers.length)]),symbolsCheck.checked&&(t+=charSets.symbols,o+=charSets.symbols[Math.floor(Math.random()*charSets.symbols.length)]),""===t)return void showAlert("Please select at least one character type.","error");let n=o;for(let a=o.length;a<e;a++)n+=t.charAt(Math.floor(Math.random()*t.length));passwordOutput.value=n.split("").sort(()=>.5-Math.random()).join("")},copyBtn.onclick=()=>{passwordOutput.value&&navigator.clipboard.writeText(passwordOutput.value).then(()=>showAlert("Password copied!","success"))};
            },
            base64EncoderDecoder: (container) => {
                container.innerHTML = `<textarea id="b64Input" placeholder="Enter text to encode or Base64 to decode" rows="5"></textarea><div style="margin-top:1rem;"><button id="b64EncodeBtn">Encode</button> <button id="b64DecodeBtn">Decode</button></div>`;
                const ioArea=container.querySelector("#b64Input");container.querySelector("#b64EncodeBtn").onclick=()=>{try{ioArea.value=btoa(unescape(encodeURIComponent(ioArea.value)))}catch(e){showAlert("Error encoding.","error")}},container.querySelector("#b64DecodeBtn").onclick=()=>{try{ioArea.value=decodeURIComponent(escape(atob(ioArea.value)))}catch(e){showAlert("Error decoding: Invalid Base64 string.","error")}};
            },
            urlEncoderDecoder: (container) => {
                container.innerHTML = `<textarea id="urlInput" placeholder="Enter URL or text..." rows="6"></textarea><div style="margin-top:1rem; display:flex; gap:10px;"><button id="urlEncodeBtn">Encode</button><button id="urlDecodeBtn">Decode</button></div>`;
                const ioArea=container.querySelector("#urlInput");container.querySelector("#urlEncodeBtn").onclick=()=>{try{ioArea.value=encodeURIComponent(ioArea.value);showAlert("Encoded successfully!","success")}catch(e){showAlert("Could not encode text.","error")}},container.querySelector("#urlDecodeBtn").onclick=()=>{try{ioArea.value=decodeURIComponent(ioArea.value);showAlert("Decoded successfully!","success")}catch(e){showAlert("Could not decode text. It might be malformed.","error")}};
            },
            jsonFormatter: (container) => {
                container.innerHTML = `<textarea id="jsonInput" placeholder="Paste your JSON data here..." rows="7"></textarea><button id="formatJsonBtn" style="margin-top:1rem;">Format JSON</button><textarea id="jsonOutput" readonly rows="7" style="margin-top:1rem;"></textarea>`;
                const inputArea=container.querySelector("#jsonInput"),outputArea=container.querySelector("#jsonOutput"),formatBtn=container.querySelector("#formatJsonBtn");formatBtn.onclick=()=>{const e=inputArea.value.trim();if(!e)return;try{const t=JSON.parse(e);outputArea.value=JSON.stringify(t,null,4);showAlert("JSON formatted successfully!","success")}catch(t){outputArea.value="Error: Invalid JSON\n\n"+t.message;showAlert("Invalid JSON.","error")}};
            },
            hashGenerator: (container) => {
                container.innerHTML = `<label for="hashInput">Text to Hash:</label><textarea id="hashInput" rows="4"></textarea><label for="hashAlgo" style="margin-top:1rem;">Algorithm:</label><select id="hashAlgo"><option value="MD5">MD5</option><option value="SHA1">SHA-1</option><option value="SHA256" selected>SHA-256</option><option value="SHA512">SHA-512</option></select><button id="generateHashBtn" style="margin-top:1rem;">Generate Hash</button><label for="hashOutput" style="margin-top:1rem;">Result:</label><textarea id="hashOutput" readonly rows="3"></textarea>`;
                const inputArea=container.querySelector("#hashInput"),algoSelect=container.querySelector("#hashAlgo"),generateBtn=container.querySelector("#generateHashBtn"),outputArea=container.querySelector("#hashOutput");generateBtn.onclick=()=>{const e=inputArea.value,t=algoSelect.value;if(!e)return void showAlert("Input text cannot be empty.","error");let o;"MD5"===t?o=CryptoJS.MD5(e):"SHA1"===t?o=CryptoJS.SHA1(e):"SHA256"===t?o=CryptoJS.SHA256(e):"SHA512"===t&&(o=CryptoJS.SHA512(e)),outputArea.value=o.toString(CryptoJS.enc.Hex)};
            },
            markdownPreviewer: (container) => {
                container.innerHTML = `<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; min-height: 50vh;"><textarea id="mdInput" style="height: 100%; resize: none;" placeholder="# Hello World!"></textarea><div id="mdOutput" class="result-area" style="height: 100%; overflow-y: auto;"></div></div>`;
                const mdInput=container.querySelector("#mdInput"),mdOutput=container.querySelector("#mdOutput");marked.setOptions({breaks:!0,gfm:!0});mdInput.oninput=()=>{const e=marked.parse(mdInput.value);mdOutput.innerHTML=DOMPurify.sanitize(e)},mdInput.value="# Welcome to Markdown!\n\n* Write list items.\n* Use **bold** and *italic*.",mdInput.dispatchEvent(new Event("input"));
            },
            colorPicker: (container) => {
                container.innerHTML = `<label for="htmlColorPicker">Select a Color:</label><input type="color" id="htmlColorPicker" value="#53a8b6" style="width:100%; height: 40px; margin-bottom:1rem;"><div class="result-area" style="text-align:center;"><div id="colorPreview" style="width: 100px; height: 100px; border-radius: 50%; margin: 0 auto 1rem; border: 3px solid white;"></div><p>HEX: <strong id="hexValue"></strong></p><p>RGB: <strong id="rgbValue"></strong></p><p>HSL: <strong id="hslValue"></strong></p></div>`;
                const colorPickerInput = container.querySelector('#htmlColorPicker'), colorPreviewDiv = container.querySelector('#colorPreview'), hexValueSpan = container.querySelector('#hexValue'), rgbValueSpan = container.querySelector('#rgbValue'), hslValueSpan = container.querySelector('#hslValue');
                function updateColorValues(hex) { const upperHex = hex.toUpperCase(); colorPreviewDiv.style.backgroundColor = upperHex; hexValueSpan.textContent = upperHex; const rgb = hexToRgb(upperHex); rgbValueSpan.textContent = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`; const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b); hslValueSpan.textContent = `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`; }
                function hexToRgb(hex) { let r=0,g=0,b=0; if(hex.length===4){r="0x"+hex[1]+hex[1]|0;g="0x"+hex[2]+hex[2]|0;b="0x"+hex[3]+hex[3]|0}else if(hex.length===7){r="0x"+hex[1]+hex[2]|0;g="0x"+hex[3]+hex[4]|0;b="0x"+hex[5]+hex[6]|0} return {r,g,b}; }
                function rgbToHsl(r, g, b) { r /= 255; g /= 255; b /= 255; const max = Math.max(r, g, b), min = Math.min(r, g, b); let h, s, l = (max + min) / 2; if (max === min) { h = s = 0; } else { const d = max - min; s = l > 0.5 ? d / (2 - max - min) : d / (max + min); switch (max) { case r: h = (g - b) / d + (g < b ? 6 : 0); break; case g: h = (b - r) / d + 2; break; case b: h = (r - g) / d + 4; break; } h /= 6; } return { h: Math.round(h*360), s: Math.round(s*100), l: Math.round(l*100) }; }
                colorPickerInput.oninput = (e) => updateColorValues(e.target.value); updateColorValues(colorPickerInput.value);
            },
            textToSpeech: (container) => {
                container.innerHTML = `<textarea id="ttsText" placeholder="Enter text to speak..." rows="6"></textarea><div style="margin-top:1rem;"><label for="ttsVoice">Voice:</label><select id="ttsVoice"></select></div><div style="margin-top:1rem; display:flex; gap:10px;"><button id="ttsSpeakBtn">Speak</button><button id="ttsStopBtn">Stop</button></div>`;
                const textInput = container.querySelector('#ttsText'), voiceSelect = container.querySelector('#ttsVoice'), speakBtn = container.querySelector('#ttsSpeakBtn'), stopBtn = container.querySelector('#ttsStopBtn'), synth = window.speechSynthesis;
                if (!synth) { container.innerHTML = "<p>Sorry, your browser doesn't support Text to Speech.</p>"; return; } let voices = [];
                function populateVoiceList() { voices = synth.getVoices(); voiceSelect.innerHTML = ''; voices.forEach((voice, i) => { const option = document.createElement('option'); option.textContent = `${voice.name} (${voice.lang})`; option.setAttribute('data-name', voice.name); voiceSelect.appendChild(option); }); }
                populateVoiceList(); if (synth.onvoiceschanged !== undefined) synth.onvoiceschanged = populateVoiceList;
                speakBtn.onclick = () => { if (synth.speaking) { synth.cancel(); } if (textInput.value !== '') { const utterThis = new SpeechSynthesisUtterance(textInput.value); const selectedOption = voiceSelect.selectedOptions[0].getAttribute('data-name'); utterThis.voice = voices.find(voice => voice.name === selectedOption); synth.speak(utterThis); } };
                stopBtn.onclick = () => { synth.cancel(); };
                window.currentToolCleanup = () => { synth.cancel(); };
            },
            speechToText: (container) => {
                container.innerHTML = `<p>Click "Start Listening" and speak into your microphone.</p><button id="sttStartBtn">Start Listening</button><button id="sttStopBtn" disabled>Stop Listening</button><textarea id="sttOutput" placeholder="Transcript will appear here..." readonly rows="6" style="margin-top:1rem;"></textarea>`;
                const startBtn = container.querySelector('#sttStartBtn'), stopBtn = container.querySelector('#sttStopBtn'), outputArea = container.querySelector('#sttOutput');
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                if (!SpeechRecognition) { container.innerHTML = '<p>Speech Recognition API is not supported in your browser.</p>'; return; }
                const recognition = new SpeechRecognition(); recognition.continuous = true; recognition.interimResults = true;
                recognition.onstart = () => { startBtn.disabled = true; stopBtn.disabled = false; showAlert('Listening...', 'info'); };
                recognition.onend = () => { startBtn.disabled = false; stopBtn.disabled = true; showAlert('Stopped listening.', 'success'); };
                recognition.onerror = (event) => { showAlert(`Speech recognition error: ${event.error}`, 'error'); };
                recognition.onresult = (event) => { let interim_transcript = '', final_transcript = ''; for (let i = event.resultIndex; i < event.results.length; ++i) { if (event.results[i].isFinal) { final_transcript += event.results[i][0].transcript; } else { interim_transcript += event.results[i][0].transcript; } } outputArea.value = final_transcript + interim_transcript; };
                startBtn.onclick = () => recognition.start(); stopBtn.onclick = () => recognition.stop();
                window.currentToolCleanup = () => { recognition.stop(); };
            },
            countdownToDate: (container) => {
                container.innerHTML = `<label for="countdownDate">Select a future date and time:</label><input type="datetime-local" id="countdownDate" style="margin-bottom:1rem;"><button id="startCountdownBtn">Start Countdown</button><div id="countdownDisplay" class="result-area" style="display:none; text-align:center; font-size:1.5rem; margin-top:1rem;"></div>`;
                const dateInput=container.querySelector("#countdownDate"),startBtn=container.querySelector("#startCountdownBtn"),display=container.querySelector("#countdownDisplay");let countdownInterval;startBtn.onclick=()=>{const e=new Date(dateInput.value);if(isNaN(e.getTime()))return void showAlert("Please select a valid date.","error");if(e<new Date)return void showAlert("Please select a future date.","error");display.style.display="block",clearInterval(countdownInterval),countdownInterval=setInterval(()=>{const t=(new Date).getTime(),o=e-t;if(o<0)return clearInterval(countdownInterval),void(display.innerHTML="🎉 The time has come! 🎉");const n=Math.floor(o/864e5),a=Math.floor(o%864e5/36e5),l=Math.floor(o%36e5/6e4),i=Math.floor(o%6e4/1e3);display.innerHTML=`<strong>${n}</strong>d <strong>${a}</strong>h <strong>${l}</strong>m <strong>${i}</strong>s`},1e3)},window.currentToolCleanup=()=>{clearInterval(countdownInterval)};
            },
            randomNumberGenerator: (container) => {
                container.innerHTML = `<div style="display:flex; gap:15px; margin-bottom:1rem;"><div><label for="minNum">Minimum:</label><input type="number" id="minNum" value="1"></div><div><label for="maxNum">Maximum:</label><input type="number" id="maxNum" value="100"></div></div><button id="generateRandomBtn">Generate</button><div id="randomResult" class="result-area" style="margin-top:1rem; text-align:center; font-size:2rem; font-weight:bold; display:none;"></div>`;
                const minInput=container.querySelector("#minNum"),maxInput=container.querySelector("#maxNum"),generateBtn=container.querySelector("#generateRandomBtn"),resultDiv=container.querySelector("#randomResult");generateBtn.onclick=()=>{const e=parseInt(minInput.value),t=parseInt(maxInput.value);if(isNaN(e)||isNaN(t)||e>t)return void showAlert("Please enter a valid min and max range.","error");const o=Math.floor(Math.random()*(t-e+1))+e;resultDiv.textContent=o,resultDiv.style.display="block"};
            },
            audioConverter: (container) => {
                container.innerHTML = `<label for="audioFile">Audio File (MP3, WAV, etc.):</label><input type="file" id="audioFile" accept="audio/*"><button id="convertAudioBtn" style="margin-top:1rem;">Convert to WAV & Download</button><div id="audioStatus" class="result-area" style="display:none; margin-top:1rem;"></div>`;
                const fileInput = container.querySelector('#audioFile'), convertBtn = container.querySelector('#convertAudioBtn'), statusDiv = container.querySelector('#audioStatus');
                convertBtn.onclick = async () => { const file = fileInput.files[0]; if (!file) { showAlert('Please select an audio file.', 'error'); return; } statusDiv.style.display = 'block'; statusDiv.textContent = 'Processing...'; try { const audioContext = new (window.AudioContext || window.webkitAudioContext)(); const arrayBuffer = await file.arrayBuffer(); const audioBuffer = await audioContext.decodeAudioData(arrayBuffer); function bufferToWav(buffer) { const numOfChan = buffer.numberOfChannels, length = buffer.length * numOfChan * 2 + 44, newBuffer = new ArrayBuffer(length), view = new DataView(newBuffer), channels = [], sampleRate = buffer.sampleRate; let offset = 0, pos = 0; function setUint16(data) { view.setUint16(pos, data, true); pos += 2; } function setUint32(data) { view.setUint32(pos, data, true); pos += 4; } setUint32(0x46464952); setUint32(length - 8); setUint32(0x45564157); setUint32(0x20746d66); setUint32(16); setUint16(1); setUint16(numOfChan); setUint32(sampleRate); setUint32(sampleRate * 2 * numOfChan); setUint16(numOfChan * 2); setUint16(16); setUint32(0x61746164); setUint32(length - pos - 4); for (let i = 0; i < buffer.numberOfChannels; i++) channels.push(buffer.getChannelData(i)); while (pos < length) { for (let i = 0; i < numOfChan; i++) { let sample = Math.max(-1, Math.min(1, channels[i][offset])); sample = (sample < 0 ? sample * 0x8000 : sample * 0x7FFF); view.setInt16(pos, sample, true); pos += 2; } offset++; } return new Blob([view], { type: 'audio/wav' }); } const wavBlob = bufferToWav(audioBuffer); const downloadUrl = URL.createObjectURL(wavBlob); const a = document.createElement('a'); a.href = downloadUrl; a.download = `${file.name.split('.')[0]}.wav`; a.click(); URL.revokeObjectURL(downloadUrl); statusDiv.textContent = 'Conversion successful!'; showAlert('Converted!', 'success'); } catch (err) { statusDiv.textContent = `Error: ${err.message}`; showAlert('Conversion failed.', 'error'); } };
            },
            audioTrimmer: (container) => {
                container.innerHTML = `<label for="trimFile">Audio File:</label><input type="file" id="trimFile" accept="audio/*"><div style="display:flex; gap: 15px; margin-top:1rem;"><div><label>Start (sec):</label><input type="number" id="startTime" value="0" min="0"></div><div><label>End (sec):</label><input type="number" id="endTime" value="10" min="0"></div></div><button id="trimAudioBtn" style="margin-top:1rem;">Trim & Download</button>`;
                const fileInput = container.querySelector('#trimFile'), startInput = container.querySelector('#startTime'), endInput = container.querySelector('#endTime'), trimBtn = container.querySelector('#trimAudioBtn'); let audioBuffer; const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                fileInput.onchange = async (e) => { const file = e.target.files[0]; if(file) { const arrayBuffer = await file.arrayBuffer(); audioBuffer = await audioContext.decodeAudioData(arrayBuffer); showAlert(`File loaded: ${audioBuffer.duration.toFixed(2)}s`, 'info'); } };
                trimBtn.onclick = async () => { if (!audioBuffer) { showAlert('Please load a file.', 'error'); return; } const startTime = parseFloat(startInput.value), endTime = parseFloat(endInput.value); if (isNaN(startTime) || isNaN(endTime) || startTime < 0 || endTime <= startTime || endTime > audioBuffer.duration) { showAlert('Invalid times.', 'error'); return; } const startOffset = Math.floor(startTime * audioBuffer.sampleRate), endOffset = Math.floor(endTime * audioBuffer.sampleRate), frameCount = endOffset - startOffset; const newBuffer = audioContext.createBuffer(audioBuffer.numberOfChannels, frameCount, audioBuffer.sampleRate); for (let i = 0; i < audioBuffer.numberOfChannels; i++) { newBuffer.getChannelData(i).set(audioBuffer.getChannelData(i).subarray(startOffset, endOffset)); } function bufferToWav(buffer) { const numOfChan = buffer.numberOfChannels, length = buffer.length * numOfChan * 2 + 44, newBuffer = new ArrayBuffer(length), view = new DataView(newBuffer), channels = [], sampleRate = buffer.sampleRate; let offset = 0, pos = 0; function setUint16(data) { view.setUint16(pos, data, true); pos += 2; } function setUint32(data) { view.setUint32(pos, data, true); pos += 4; } setUint32(0x46464952); setUint32(length - 8); setUint32(0x45564157); setUint32(0x20746d66); setUint32(16); setUint16(1); setUint16(numOfChan); setUint32(sampleRate); setUint32(sampleRate * 2 * numOfChan); setUint16(numOfChan * 2); setUint16(16); setUint32(0x61746164); setUint32(length - pos - 4); for (let i = 0; i < buffer.numberOfChannels; i++) channels.push(buffer.getChannelData(i)); while (pos < length) { for (let i = 0; i < numOfChan; i++) { let sample = Math.max(-1, Math.min(1, channels[i][offset])); sample = (sample < 0 ? sample * 0x8000 : sample * 0x7FFF); view.setInt16(pos, sample, true); pos += 2; } offset++; } return new Blob([view], { type: 'audio/wav' }); } const wavBlob = bufferToWav(newBuffer); const downloadUrl = URL.createObjectURL(wavBlob); const a = document.createElement('a'); a.href = downloadUrl; a.download = 'trimmed.wav'; a.click(); URL.revokeObjectURL(downloadUrl); showAlert('Trimmed!', 'success'); };
            },
            videoConverter: (container) => {
                container.innerHTML = `<p style="color: #f1c40f;">Video converter pehli baar time lega. Sabar rakhein.</p><label for="videoFile">Video File:</label><input type="file" id="videoFile" accept="video/*"><label for="videoFormat" style="margin-top:1rem;">Convert to:</label><select id="videoFormat"><option value="mp4">MP4</option><option value="webm">WebM</option><option value="gif">GIF</option></select><button id="convertVideoBtn" style="margin-top:1rem;">Convert Video</button><div id="videoLog" class="result-area" style="display:none; margin-top:1rem; max-height: 150px; overflow-y: auto; font-family: monospace; font-size: 0.8rem;"></div>`;
                const fileInput = container.querySelector('#videoFile'), formatSelect = container.querySelector('#videoFormat'), convertBtn = container.querySelector('#convertVideoBtn'), logDiv = container.querySelector('#videoLog');
                const { createFFmpeg, fetchFile } = FFmpeg;
                const ffmpeg = createFFmpeg({ log: true, corePath: 'https://unpkg.com/@ffmpeg/core@0.11.0/dist/ffmpeg-core.js' });
                ffmpeg.setLogger(({ type, message }) => { logDiv.style.display = 'block'; logDiv.innerHTML += `${message}<br>`; logDiv.scrollTop = logDiv.scrollHeight; });
                convertBtn.onclick = async () => { const file = fileInput.files[0]; if (!file) { showAlert('Please select a video file.', 'error'); return; } logDiv.innerHTML = 'Starting...<br>'; convertBtn.disabled = true; try { if (!ffmpeg.isLoaded()) { logDiv.innerHTML += 'Loading FFmpeg-core.js...<br>'; await ffmpeg.load(); } const outFormat = formatSelect.value; const outFilename = `output.${outFormat}`; logDiv.innerHTML += 'Writing file...<br>'; ffmpeg.FS('writeFile', file.name, await fetchFile(file)); logDiv.innerHTML += 'Running FFmpeg...<br>'; if(outFormat === 'gif') { await ffmpeg.run('-i', file.name, '-vf', 'fps=10,scale=320:-1:flags=lanczos', outFilename); } else { await ffmpeg.run('-i', file.name, outFilename); } logDiv.innerHTML += 'Complete. Reading file...<br>'; const data = ffmpeg.FS('readFile', outFilename); const blob = new Blob([data.buffer], { type: outFormat === 'gif' ? 'image/gif' : `video/${outFormat}` }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = `${file.name.split('.')[0]}.${outFormat}`; a.click(); URL.revokeObjectURL(url); showAlert('Converted!', 'success'); } catch (error) { logDiv.innerHTML += `<br><strong style="color:red;">Error: ${error.message}</strong>`; showAlert('Conversion failed.', 'error'); } finally { convertBtn.disabled = false; } };
            },
            timerStopwatch: (container) => {
                container.innerHTML = `
                    <div class="tabs" style="display:flex; margin-bottom:1rem; border-bottom:1px solid var(--tool-card-background);">
                        <button class="tab-button active" data-tab="timer">Timer</button>
                        <button class="tab-button" data-tab="stopwatch">Stopwatch</button>
                    </div>
                    <div id="timer" class="tab-content">
                        <div style="display:flex; justify-content:space-around; margin-bottom:1rem; text-align:center;">
                            <div><label>Hours</label><br><input type="number" id="timerHours" value="0" min="0" style="width:70px;"></div>
                            <div><label>Minutes</label><br><input type="number" id="timerMinutes" value="5" min="0" max="59" style="width:70px;"></div>
                            <div><label>Seconds</label><br><input type="number" id="timerSeconds" value="0" min="0" max="59" style="width:70px;"></div>
                        </div>
                        <div style="font-size: 3rem; text-align:center; font-family: monospace;" id="timerDisplay">00:05:00</div>
                        <div style="text-align:center; margin-top:1.5rem; display:flex; gap:10px; justify-content:center;">
                            <button id="timerStart">Start</button>
                            <button id="timerPause" disabled>Pause</button>
                            <button id="timerReset">Reset</button>
                        </div>
                    </div>
                    <div id="stopwatch" class="tab-content" style="display:none;">
                        <div style="font-size: 3rem; text-align:center; font-family: monospace;" id="stopwatchDisplay">00:00:00.000</div>
                         <div style="text-align:center; margin-top:1.5rem; display:flex; gap:10px; justify-content:center;">
                            <button id="stopwatchStart">Start</button>
                            <button id="stopwatchPause" disabled>Pause</button>
                            <button id="stopwatchReset">Reset</button>
                            <button id="stopwatchLap" disabled>Lap</button>
                        </div>
                        <ol id="lapsList" style="list-style-type:decimal; padding-left: 20px; margin-top:1.5rem; max-height:150px; overflow-y:auto;"></ol>
                    </div>`;

                const tabs = container.querySelectorAll('.tab-button');
                const contents = container.querySelectorAll('.tab-content');
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        tabs.forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        contents.forEach(c => c.style.display = 'none');
                        container.querySelector(`#${tab.dataset.tab}`).style.display = 'block';
                    });
                });
                
                let timerInterval, stopwatchInterval;
                const h_in = container.querySelector('#timerHours'), m_in = container.querySelector('#timerMinutes'), s_in = container.querySelector('#timerSeconds');
                const timerDisplay = container.querySelector('#timerDisplay');
                const timerStartBtn = container.querySelector('#timerStart'), timerPauseBtn = container.querySelector('#timerPause'), timerResetBtn = container.querySelector('#timerReset');
                let totalSeconds;

                function updateTimerDisplay() {
                    if (totalSeconds < 0) return;
                    const h = Math.floor(totalSeconds / 3600);
                    const m = Math.floor((totalSeconds % 3600) / 60);
                    const s = totalSeconds % 60;
                    timerDisplay.textContent = `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
                }

                timerStartBtn.onclick = () => {
                    if (timerStartBtn.disabled) return;
                    totalSeconds = (parseInt(h_in.value) * 3600) + (parseInt(m_in.value) * 60) + parseInt(s_in.value);
                    if (isNaN(totalSeconds) || totalSeconds <= 0) { showAlert('Please set a valid time.', 'error'); return; }
                    clearInterval(timerInterval);
                    timerInterval = setInterval(() => {
                        if (totalSeconds > 0) {
                            totalSeconds--;
                            updateTimerDisplay();
                        } else {
                            clearInterval(timerInterval);
                            showAlert('Time is up!', 'success');
                            timerStartBtn.disabled = false; timerPauseBtn.disabled = true;
                        }
                    }, 1000);
                    timerStartBtn.disabled = true; timerPauseBtn.disabled = false;
                };
                timerPauseBtn.onclick = () => { clearInterval(timerInterval); timerStartBtn.disabled = false; timerPauseBtn.disabled = true; };
                timerResetBtn.onclick = () => {
                    clearInterval(timerInterval);
                    h_in.value = 0; m_in.value = 5; s_in.value = 0;
                    totalSeconds = 300; updateTimerDisplay();
                    timerStartBtn.disabled = false; timerPauseBtn.disabled = true;
                };

                const stopwatchDisplay = container.querySelector('#stopwatchDisplay');
                const swStartBtn = container.querySelector('#stopwatchStart'), swPauseBtn = container.querySelector('#stopwatchPause'), swResetBtn = container.querySelector('#stopwatchReset'), swLapBtn = container.querySelector('#stopwatchLap');
                const lapsList = container.querySelector('#lapsList');
                let startTime, elapsedTime = 0, lapCounter = 1;

                function updateStopwatchDisplay() { const ms = elapsedTime % 1000; const s = Math.floor(elapsedTime / 1000) % 60; const m = Math.floor(elapsedTime / 60000) % 60; stopwatchDisplay.textContent = `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}.${String(ms).padStart(3, '0')}`; }
                swStartBtn.onclick = () => {
                    startTime = Date.now() - elapsedTime;
                    clearInterval(stopwatchInterval);
                    stopwatchInterval = setInterval(() => { elapsedTime = Date.now() - startTime; updateStopwatchDisplay(); }, 10);
                    swStartBtn.disabled = true; swPauseBtn.disabled = false; swLapBtn.disabled = false;
                };
                swPauseBtn.onclick = () => { clearInterval(stopwatchInterval); swStartBtn.disabled = false; swPauseBtn.disabled = true; swLapBtn.disabled = true; };
                swResetBtn.onclick = () => {
                    clearInterval(stopwatchInterval); elapsedTime = 0; updateStopwatchDisplay();
                    lapsList.innerHTML = ''; lapCounter = 1;
                    swStartBtn.disabled = false; swPauseBtn.disabled = true; swLapBtn.disabled = true;
                };
                swLapBtn.onclick = () => { const li = document.createElement('li'); li.textContent = `Lap ${lapCounter}: ${stopwatchDisplay.textContent}`; lapsList.prepend(li); lapCounter++; };
                window.currentToolCleanup = () => { clearInterval(timerInterval); clearInterval(stopwatchInterval); };
            }
        };
    });
    </script>
</body>
</html>
